<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>PropertyHub - Real Estate Portfolio Management</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Mobile Hamburger Menu Button -->
        <button id="hamburger-menu" class="hamburger-menu" aria-label="Toggle menu" aria-expanded="false">
            <span class="hamburger-icon">‚ò∞</span>
        </button>

        <!-- Sidebar Backdrop (for mobile) -->
        <div class="sidebar-backdrop" id="sidebar-backdrop" aria-hidden="true"></div>

        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1 class="logo">PropertyHub</h1>
                <p class="tagline">Real Estate Portfolio Management</p>
            </div>

            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-view="properties">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-label">Properties</span>
                </a>
                <a href="#" class="nav-item" data-view="mortgages">
                    <span class="nav-icon">üí∞</span>
                    <span class="nav-label">Mortgages</span>
                </a>
                <a href="#" class="nav-item" data-view="expenses">
                    <span class="nav-icon">üí∏</span>
                    <span class="nav-label">Expenses</span>
                </a>
                <a href="#" class="nav-item" data-view="utilities">
                    <span class="nav-icon">‚ö°</span>
                    <span class="nav-label">Utilities</span>
                </a>
                <a href="#" class="nav-item" data-view="contacts">
                    <span class="nav-icon">üë•</span>
                    <span class="nav-label">Contacts</span>
                </a>
                <a href="#" class="nav-item" data-view="tenants">
                    <span class="nav-icon">üë§</span>
                    <span class="nav-label">Tenants</span>
                </a>
                <a href="#" class="nav-item" data-view="rent_payments">
                    <span class="nav-icon">üíµ</span>
                    <span class="nav-label">Rent Payments</span>
                </a>
                <a href="#" class="nav-item" data-view="insurance">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-label">Insurance</span>
                </a>
                <a href="#" class="nav-item" data-view="tasks">
                    <span class="nav-icon">‚úÖ</span>
                    <span class="nav-label">Tasks</span>
                </a>
                <a href="#" class="nav-item" data-view="analytics">
                    <span class="nav-icon">üìà</span>
                    <span class="nav-label">Analytics</span>
                </a>
                <a href="#" class="nav-item" data-view="refinance">
                    <span class="nav-icon">üîÑ</span>
                    <span class="nav-label">Refinance</span>
                </a>
                <a href="#" class="nav-item" data-view="financial_decisions">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Decisions</span>
                </a>
                <a href="#" class="nav-item" data-view="predictive">
                    <span class="nav-icon">üîÆ</span>
                    <span class="nav-label">Forecasting</span>
                </a>
                <a href="#" class="nav-item" data-view="tax">
                    <span class="nav-icon">üèõÔ∏è</span>
                    <span class="nav-label">Tax Optimization</span>
                </a>
                <a href="#" class="nav-item" data-view="automation">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span class="nav-label">Automation</span>
                </a>
                <a href="#" class="nav-item" data-view="financial_analytics">
                    <span class="nav-icon">üíπ</span>
                    <span class="nav-label">Financial Analytics</span>
                </a>
                <a href="#" class="nav-item" data-view="kpi_monitoring">
                    <span class="nav-icon">‚ö†Ô∏è</span>
                    <span class="nav-label">KPI Alerts</span>
                </a>
                <a href="#" class="nav-item" data-view="scenario_analysis">
                    <span class="nav-icon">üéØ</span>
                    <span class="nav-label">Scenarios</span>
                </a>
                <a href="#" class="nav-item" data-view="benchmarking">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">Benchmarking</span>
                </a>
                <a href="#" class="nav-item" data-view="investment_analysis">
                    <span class="nav-icon">üí∞</span>
                    <span class="nav-label">ROI Analysis</span>
                </a>
                <a href="#" class="nav-item" data-view="financial_reports">
                    <span class="nav-icon">üìÑ</span>
                    <span class="nav-label">Reports</span>
                </a>
                <a href="#" class="nav-item" data-view="ml_analytics">
                    <span class="nav-icon">ü§ñ</span>
                    <span class="nav-label">ML Analytics</span>
                </a>
                <a href="#" class="nav-item" data-view="users">
                    <span class="nav-icon">üë•</span>
                    <span class="nav-label">Users</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <button id="sync-btn" class="sync-btn" title="Sync data">üîÑ Sync</button>
                <p class="sync-status">Last sync: never</p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="top-header">
                <div class="header-left">
                    <h2 id="page-title">Dashboard</h2>
                </div>
                <div class="header-right">
                    <span id="user-email" class="user-email">Loading...</span>
                    <button id="add-item-btn" class="btn-primary">+ Add Item</button>
                </div>
            </header>

            <!-- Views Container -->
            <div class="views-container">

                <!-- Dashboard View -->
                <div id="dashboard-view" class="view active">
                    <div class="dashboard-grid">
                        <!-- Portfolio Metrics -->
                        <div class="metrics-section">
                            <div class="metric-card metric-total-value">
                                <div class="metric-label">Total Portfolio Value</div>
                                <div class="metric-value" id="total-value">$0</div>
                                <div class="metric-detail">Current market value of all properties</div>
                            </div>
                            <div class="metric-card metric-total-debt">
                                <div class="metric-label">Total Debt</div>
                                <div class="metric-value" id="total-debt">$0</div>
                                <div class="metric-detail">Combined mortgage balances</div>
                            </div>
                            <div class="metric-card metric-total-equity">
                                <div class="metric-label">Total Equity</div>
                                <div class="metric-value" id="total-equity">$0</div>
                                <div class="metric-detail">Portfolio net worth</div>
                            </div>
                            <div class="metric-card metric-monthly-income">
                                <div class="metric-label">Monthly Income</div>
                                <div class="metric-value" id="monthly-income">$0</div>
                                <div class="metric-detail">Projected rental income</div>
                            </div>
                        </div>

                        <!-- Properties Summary -->
                        <div class="summary-section">
                            <h3>Properties Summary</h3>
                            <div id="properties-summary" class="properties-grid">
                                <p class="loading">Loading properties...</p>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="actions-section">
                            <h3>Quick Actions</h3>
                            <div class="action-buttons">
                                <button class="action-btn" data-action="add-property">
                                    <span class="icon">+</span>
                                    Add Property
                                </button>
                                <button class="action-btn" data-action="add-mortgage">
                                    <span class="icon">+</span>
                                    Add Mortgage
                                </button>
                                <button class="action-btn" data-action="add-expense">
                                    <span class="icon">+</span>
                                    Add Expense
                                </button>
                                <button class="action-btn" data-action="refresh">
                                    <span class="icon">üîÑ</span>
                                    Refresh Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Properties View -->
                <div id="properties-view" class="view">
                    <div class="view-header">
                        <h3>All Properties</h3>
                        <button class="btn-primary" id="new-property-btn">+ New Property</button>
                    </div>

                    <div id="properties-list" class="properties-list">
                        <p class="loading">Loading properties...</p>
                    </div>

                    <!-- Property Form Modal -->
                    <div id="property-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Add/Edit Property</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="property-form" class="form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Address *</label>
                                        <input type="text" name="address" required>
                                    </div>
                                    <div class="form-group">
                                        <label>City *</label>
                                        <input type="text" name="city" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>State *</label>
                                        <input type="text" name="state" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Zip Code</label>
                                        <input type="text" name="zip">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Purchase Price *</label>
                                        <input type="number" name="purchase_price" required step="0.01">
                                    </div>
                                    <div class="form-group">
                                        <label>Purchase Date *</label>
                                        <input type="date" name="purchase_date" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Current Value *</label>
                                        <input type="number" name="current_value" required step="0.01">
                                    </div>
                                    <div class="form-group">
                                        <label>Property Type</label>
                                        <select name="type">
                                            <option value="single_family">Single Family</option>
                                            <option value="multi_family">Multi-Family</option>
                                            <option value="condo">Condo</option>
                                            <option value="commercial">Commercial</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Save Property</button>
                                    <button type="button" class="btn-secondary" id="cancel-property">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Mortgages View -->
                <div id="mortgages-view" class="view">
                    <div class="view-header">
                        <h3>Mortgages</h3>
                        <button class="btn-primary" id="new-mortgage-btn">+ New Mortgage</button>
                    </div>

                    <div id="mortgages-list" class="mortgages-list">
                        <p class="loading">Loading mortgages...</p>
                    </div>

                    <!-- Mortgage Form Modal -->
                    <div id="mortgage-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Add/Edit Mortgage</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="mortgage-form" class="form">
                                <div class="form-group">
                                    <label>Property *</label>
                                    <select name="property_id" id="mortgage-property-select" required>
                                        <option value="">Select a property...</option>
                                    </select>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Lender *</label>
                                        <input type="text" name="lender" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Original Balance *</label>
                                        <input type="number" name="original_balance" required step="0.01">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Current Balance *</label>
                                        <input type="number" name="current_balance" required step="0.01">
                                    </div>
                                    <div class="form-group">
                                        <label>Interest Rate (%) *</label>
                                        <input type="number" name="interest_rate" required step="0.001">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Monthly Payment *</label>
                                        <input type="number" name="monthly_payment" required step="0.01">
                                    </div>
                                    <div class="form-group">
                                        <label>Remaining Term (months) *</label>
                                        <input type="number" name="remaining_term_months" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Refinance Eligible Date</label>
                                        <input type="date" name="refinance_eligible_date">
                                    </div>
                                    <div class="form-group">
                                        <label>Escrow Amount (monthly)</label>
                                        <input type="number" name="escrow_payment" step="0.01">
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Save Mortgage</button>
                                    <button type="button" class="btn-secondary" id="cancel-mortgage">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Expenses View -->
                <div id="expenses-view" class="view">
                    <div class="view-header">
                        <h3>Expenses</h3>
                        <button class="btn-primary" id="new-expense-btn">+ New Expense</button>
                    </div>

                    <div id="expenses-list" class="expenses-list">
                        <p class="loading">Loading expenses...</p>
                    </div>
                </div>

                <!-- Utilities View -->
                <div id="utilities-view" class="view">
                    <div class="view-header">
                        <h3>Utilities Management</h3>
                    </div>

                    <div id="utilities-list" class="utilities-list">
                        <p class="loading">Loading utilities...</p>
                    </div>

                    <!-- Utilities Form Modal -->
                    <div id="utilities-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Edit Utilities</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="utilities-form" class="form">
                                <div class="form-group">
                                    <label>Property</label>
                                    <input type="text" name="address" readonly>
                                </div>

                                <div class="form-group">
                                    <label>Electricity Provider</label>
                                    <input type="text" name="electricity_provider">
                                    <label>Account Number</label>
                                    <input type="text" name="electricity_account_num">
                                </div>

                                <div class="form-group">
                                    <label>Electricity Responsibility</label>
                                    <select name="electricity_responsibility">
                                        <option value="Direct">Direct (Tenant pays provider)</option>
                                        <option value="Owner">Owner (I pay, included in rent)</option>
                                        <option value="Reimburse">Reimburse (I pay, tenant reimburses)</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>Water Provider</label>
                                    <input type="text" name="water_provider">
                                    <label>Account Number</label>
                                    <input type="text" name="water_account_num">
                                </div>

                                <div class="form-group">
                                    <label>Water Responsibility</label>
                                    <select name="water_responsibility">
                                        <option value="Direct">Direct (Tenant pays provider)</option>
                                        <option value="Owner">Owner (I pay, included in rent)</option>
                                        <option value="Reimburse">Reimburse (I pay, tenant reimburses)</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>Gas Provider</label>
                                    <input type="text" name="gas_provider">
                                    <label>Account Number</label>
                                    <input type="text" name="gas_account_num">
                                </div>

                                <div class="form-group">
                                    <label>Gas Responsibility</label>
                                    <select name="gas_responsibility">
                                        <option value="Direct">Direct (Tenant pays provider)</option>
                                        <option value="Owner">Owner (I pay, included in rent)</option>
                                        <option value="Reimburse">Reimburse (I pay, tenant reimburses)</option>
                                    </select>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Save Utilities</button>
                                    <button type="button" class="btn-secondary" id="cancel-utilities">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Contacts View -->
                <div id="contacts-view" class="view">
                    <div class="view-header">
                        <h3>Contacts Directory</h3>
                        <button class="btn-primary" id="new-contact-btn">+ New Contact</button>
                    </div>

                    <div id="contacts-list" class="contacts-list">
                        <p class="loading">Loading contacts...</p>
                    </div>

                    <!-- Contacts Form Modal -->
                    <div id="contacts-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Add/Edit Contact</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="contacts-form" class="form">
                                <div class="form-group">
                                    <label>Property (Optional)</label>
                                    <select id="contact-property-select" name="property_id">
                                        <option value="">Select a property...</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Contact Type *</label>
                                        <select name="contact_type" required>
                                            <option value="utility_company">Utility Company</option>
                                            <option value="contractor">Contractor</option>
                                            <option value="hoa">HOA</option>
                                            <option value="property_manager">Property Manager</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Name *</label>
                                        <input type="text" name="name" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Phone</label>
                                        <input type="tel" name="phone">
                                    </div>
                                    <div class="form-group">
                                        <label>Email</label>
                                        <input type="email" name="email">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Address</label>
                                    <input type="text" name="address">
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Service Type</label>
                                        <input type="text" name="service_type" placeholder="e.g., Electrical, Plumbing">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Notes</label>
                                    <textarea name="notes" rows="3" placeholder="Any additional information..."></textarea>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Save Contact</button>
                                    <button type="button" class="btn-secondary" id="cancel-contact">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Tenants View -->
                <div id="tenants-view" class="view">
                    <div class="view-header">
                        <h3>Tenants</h3>
                        <button class="btn-primary" id="new-tenant-btn">+ New Tenant</button>
                    </div>

                    <div id="tenants-list" class="tenants-list">
                        <p class="loading">Loading tenants...</p>
                    </div>

                    <!-- Tenant Form Modal -->
                    <div id="tenants-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Add/Edit Tenant</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="tenants-form" class="form">
                                <div class="form-group">
                                    <label>Property *</label>
                                    <select id="tenant-property-select" name="property_id" required>
                                        <option value="">Select property...</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Name *</label>
                                        <input type="text" name="name" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Status</label>
                                        <select name="status">
                                            <option value="active">Active</option>
                                            <option value="vacant">Vacant</option>
                                            <option value="past">Past Tenant</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Phone</label>
                                        <input type="tel" name="phone">
                                    </div>
                                    <div class="form-group">
                                        <label>Email</label>
                                        <input type="email" name="email">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Monthly Rent *</label>
                                        <input type="number" name="monthly_rent" step="0.01" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Security Deposit</label>
                                        <input type="number" name="security_deposit" step="0.01">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Lease Start Date *</label>
                                        <input type="date" name="lease_start_date" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Lease End Date *</label>
                                        <input type="date" name="lease_end_date" required>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Save Tenant</button>
                                    <button type="button" class="btn-secondary" id="cancel-tenant">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Rent Payments View -->
                <div id="rent_payments-view" class="view">
                    <div class="view-header">
                        <h3>Rent Payments</h3>
                        <button class="btn-primary" id="record-payment-btn">+ Record Payment</button>
                    </div>

                    <div id="rent-payments-list" class="rent-payments-list">
                        <p class="loading">Loading rent payments...</p>
                    </div>

                    <!-- Rent Payment Form Modal -->
                    <div id="rent-payment-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Record Rent Payment</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="rent-payment-form" class="form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Month *</label>
                                        <input type="month" id="payment-month" name="month" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Tenant *</label>
                                        <select id="payment-tenant-select" name="tenant_id" required>
                                            <option value="">Select tenant...</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Amount *</label>
                                        <input type="number" id="payment-amount" name="amount" step="0.01" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Status</label>
                                        <select id="payment-status" name="status">
                                            <option value="pending">Pending</option>
                                            <option value="paid">Paid</option>
                                            <option value="late">Late</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Paid Date (if paid)</label>
                                    <input type="date" id="payment-paid-date" name="paid_date">
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Record Payment</button>
                                    <button type="button" class="btn-secondary" id="cancel-rent-payment">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Insurance View -->
                <div id="insurance-view" class="view">
                    <div class="view-header">
                        <h3>Insurance Policies</h3>
                        <button class="btn-primary" id="new-insurance-btn">+ New Policy</button>
                    </div>

                    <div id="insurance-list" class="insurance-list">
                        <p class="loading">Loading insurance policies...</p>
                    </div>

                    <!-- Insurance Form Modal -->
                    <div id="insurance-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Add/Edit Insurance Policy</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="insurance-form" class="form">
                                <div class="form-group">
                                    <label>Property *</label>
                                    <select id="insurance-property-select" name="property_id" required>
                                        <option value="">Select property...</option>
                                    </select>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Policy Type *</label>
                                        <select name="policy_type" required>
                                            <option value="">Select type...</option>
                                            <option value="property">Property Insurance</option>
                                            <option value="liability">Liability Insurance</option>
                                            <option value="umbrella">Umbrella Insurance</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Provider *</label>
                                        <input type="text" name="provider" required>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Policy Number</label>
                                        <input type="text" name="policy_number">
                                    </div>
                                    <div class="form-group">
                                        <label>Coverage Amount</label>
                                        <input type="number" name="coverage_amount" step="0.01">
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Annual Premium</label>
                                        <input type="number" name="annual_premium" step="0.01">
                                    </div>
                                    <div class="form-group">
                                        <label>Expiry Date *</label>
                                        <input type="date" name="expiry_date" required>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Save Policy</button>
                                    <button type="button" class="btn-secondary" id="cancel-insurance">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Tasks View -->
                <div id="tasks-view" class="view">
                    <div class="view-header">
                        <h3>Tasks & Reminders</h3>
                        <button class="btn-primary" id="new-task-btn">+ New Task</button>
                    </div>

                    <div id="tasks-list" class="tasks-list">
                        <p class="loading">Loading tasks...</p>
                    </div>

                    <!-- Task Form Modal -->
                    <div id="task-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Add/Edit Task</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form id="task-form" class="form">
                                <div class="form-group">
                                    <label>Property *</label>
                                    <select id="task-property-select" name="property_id" required>
                                        <option value="">Select property...</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>Task Title *</label>
                                    <input type="text" name="title" required>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Category *</label>
                                        <select name="category" required>
                                            <option value="">Select category...</option>
                                            <option value="maintenance">üîß Maintenance</option>
                                            <option value="inspection">üîç Inspection</option>
                                            <option value="lease_renewal">üìÑ Lease Renewal</option>
                                            <option value="insurance">üìã Insurance</option>
                                            <option value="rent_collection">üí∞ Rent Collection</option>
                                            <option value="other">üìù Other</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Due Date *</label>
                                        <input type="date" name="due_date" required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Assigned To</label>
                                    <input type="text" name="assigned_to" placeholder="Optional: person name">
                                </div>

                                <div class="form-group">
                                    <label>Status</label>
                                    <div class="radio-group">
                                        <label><input type="radio" name="status" value="pending" checked> Pending</label>
                                        <label><input type="radio" name="status" value="completed"> Completed</label>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Save Task</button>
                                    <button type="button" class="btn-secondary" id="cancel-task">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Analytics View -->
                <div id="analytics-view" class="view">
                    <div class="view-header">
                        <h3>Analytics & Reports</h3>
                        <div class="report-controls">
                            <select id="period-selector">
                                <option value="today">Today</option>
                                <option value="month">This Month</option>
                                <option value="quarter">This Quarter</option>
                                <option value="year" selected>This Year</option>
                                <option value="custom">Custom Range</option>
                            </select>
                            <input type="date" id="report-start-date" class="hidden">
                            <input type="date" id="report-end-date" class="hidden">
                            <button id="apply-period-btn" class="btn-primary hidden">Apply</button>
                            <button id="export-csv-btn" class="btn-secondary">üì• Export CSV</button>
                            <button id="print-report-btn" class="btn-secondary">üñ®Ô∏è Print</button>
                        </div>
                    </div>

                    <div id="analytics-container" class="analytics-container">
                        <!-- Portfolio Performance Section -->
                        <div class="report-section">
                            <h4>Portfolio Performance</h4>
                            <div id="portfolio-performance-section" class="metric-grid">
                                <p class="loading">Loading metrics...</p>
                            </div>
                        </div>

                        <!-- Property Comparison Section -->
                        <div class="report-section">
                            <h4>Property Comparison</h4>
                            <div id="property-comparison-section">
                                <p class="loading">Loading properties...</p>
                            </div>
                        </div>

                        <!-- Expense Analysis Section -->
                        <div class="report-section">
                            <h4>Expense Analysis</h4>
                            <div id="expense-analysis-section">
                                <p class="loading">Loading expenses...</p>
                            </div>
                        </div>

                        <!-- Trend Chart Section -->
                        <div class="report-section">
                            <h4>Income vs Expenses Trend</h4>
                            <div id="trend-chart-section">
                                <p class="loading">Loading trend data...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Refinance Calculator View -->
                <div id="refinance-view" class="view">
                    <div class="view-header">
                        <h3>Refinance Calculator</h3>
                        <p class="view-description">Analyze refinancing options and calculate break-even points</p>
                    </div>
                    <div id="refinance-container" class="refinance-container">
                        <p class="loading">Loading refinance calculator...</p>
                    </div>
                </div>

                <!-- Financial Decisions View -->
                <div id="financial_decisions-view" class="view">
                    <div class="view-header">
                        <h3>Financial Decision Log</h3>
                        <p class="view-description">Track refinance, sale, and property investment decisions with outcomes</p>
                    </div>
                    <div id="decisions-container" class="decisions-container">
                        <p class="loading">Loading decisions...</p>
                    </div>
                </div>

                <!-- Users Management View -->
                <div id="users-view" class="view">
                    <div class="view-header">
                        <h3>User Management</h3>
                        <button class="btn-primary" id="invite-user-btn">+ Invite User</button>
                    </div>

                    <div class="users-management-container">
                        <!-- Users List -->
                        <div class="users-section">
                            <h4>Active Users</h4>
                            <div id="users-list" class="users-list">
                                <p class="loading">Loading users...</p>
                            </div>
                        </div>

                        <!-- Active Sessions -->
                        <div class="sessions-section">
                            <h4>Active Sessions</h4>
                            <div id="active-sessions" class="sessions-list">
                                <p class="loading">Loading sessions...</p>
                            </div>
                        </div>

                        <!-- Activity Audit Log -->
                        <div class="audit-section">
                            <h4>Recent Activity</h4>
                            <div id="activity-log" class="activity-log">
                                <p class="loading">Loading activity...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Invite User Modal -->
                    <div id="invite-modal" class="modal hidden">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Invite User</h3>
                                <button class="close-btn">&times;</button>
                            </div>
                            <form class="form">
                                <div class="form-group">
                                    <label>Email Address *</label>
                                    <input type="email" name="email" placeholder="user@example.com" required>
                                </div>
                                <div class="form-group">
                                    <label>Role *</label>
                                    <select name="role" required>
                                        <option value="">Select role...</option>
                                        <option value="manager">üìã Manager - Add properties, manage tenants</option>
                                        <option value="accountant">üìä Accountant - View financials, generate reports</option>
                                        <option value="tenant">üë§ Tenant - View own lease and payments</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Message (Optional)</label>
                                    <textarea name="message" placeholder="Add a message to the invitation..." rows="3"></textarea>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">Send Invitation</button>
                                    <button type="button" class="btn-secondary" id="cancel-invite">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Predictive Analytics & Forecasting View -->
                <div id="predictive-view" class="view">
                    <div class="view-header">
                        <h3>Forecasting & Predictive Analytics</h3>
                        <p class="view-description">Forecast cash flow, expenses, and property appreciation using historical trends</p>
                    </div>
                    <div id="predictive-container" class="predictive-container">
                        <p class="loading">Loading forecasting tools...</p>
                    </div>
                </div>

                <!-- Tax Optimization View -->
                <div id="tax-view" class="view">
                    <div class="view-header">
                        <h3>Tax Optimization & Deductions</h3>
                        <p class="view-description">Calculate depreciation schedules, identify tax savings, and plan for deductions</p>
                    </div>
                    <div id="tax-container" class="tax-container">
                        <p class="loading">Loading tax tools...</p>
                    </div>
                </div>

                <!-- Automation Engine View -->
                <div id="automation-view" class="view">
                    <div class="view-header">
                        <h3>Automation & Recurring Tasks</h3>
                        <p class="view-description">Create automated task schedules, set reminders, and streamline operations</p>
                    </div>
                    <div id="automation-container" class="automation-container">
                        <p class="loading">Loading automation engine...</p>
                    </div>
                </div>

                <!-- Financial Analytics View -->
                <div id="financial-analytics-view" class="view">
                    <div class="view-header">
                        <h3>Financial Analytics & Business Intelligence</h3>
                        <p class="view-description">Advanced financial metrics, scenario modeling, and portfolio intelligence</p>
                    </div>
                    <div id="financial-analytics-container" class="financial-analytics-container">
                        <p class="loading">Loading financial analytics...</p>
                    </div>
                </div>

                <!-- KPI Monitoring View -->
                <div id="kpi-monitoring-view" class="view">
                    <div class="view-header">
                        <h3>KPI Monitoring & Alerts</h3>
                        <p class="view-description">Real-time threshold monitoring and actionable alerts</p>
                    </div>
                    <div id="kpi-monitoring-container" class="kpi-monitoring-container">
                        <p class="loading">Analyzing KPI thresholds...</p>
                    </div>
                </div>

                <!-- Scenario Analysis View -->
                <div id="scenario-analysis-view" class="view">
                    <div class="view-header">
                        <h3>Scenario Analysis & What-If Modeling</h3>
                        <p class="view-description">12-60 month projections and strategic planning</p>
                    </div>
                    <div id="scenario-analysis-container" class="scenario-analysis-container">
                        <p class="loading">Loading scenario analysis...</p>
                    </div>
                </div>

                <!-- Benchmarking View -->
                <div id="benchmarking-view" class="view">
                    <div class="view-header">
                        <h3>Portfolio Benchmarking</h3>
                        <p class="view-description">Regional and peer performance comparison</p>
                    </div>
                    <div id="benchmarking-container" class="benchmarking-container">
                        <p class="loading">Analyzing portfolio against benchmarks...</p>
                    </div>
                </div>

                <!-- Investment Analysis View -->
                <div id="investment-analysis-view" class="view">
                    <div class="view-header">
                        <h3>Investment Performance Analysis</h3>
                        <p class="view-description">ROI ranking and strategic investment recommendations</p>
                    </div>
                    <div id="investment-analysis-container" class="investment-analysis-container">
                        <p class="loading">Analyzing investment performance...</p>
                    </div>
                </div>

                <!-- Financial Reports View -->
                <div id="financial-reports-view" class="view">
                    <div class="view-header">
                        <h3>Financial Reports & Exports</h3>
                        <p class="view-description">Generate comprehensive reports in multiple formats</p>
                    </div>
                    <div id="financial-reports-container" class="financial-reports-container">
                        <p class="loading">Loading report templates...</p>
                    </div>
                </div>

                <!-- ML Analytics View -->
                <div id="ml-analytics-view" class="view">
                    <div class="view-header">
                        <h3>Machine Learning Analytics</h3>
                        <p class="view-description">AI-powered predictions and market insights</p>
                    </div>
                    <div id="ml-analytics-container" class="ml-analytics-container">
                        <p class="loading">Analyzing market trends and predictions...</p>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Error/Status Toast -->
    <div id="toast" class="toast hidden"></div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/formatting.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/utils/calculations.js"></script>
    <script src="js/utils/reports.js"></script>
    <script src="js/api.js"></script>
    <script src="js/modules/dashboard.js"></script>
    <script src="js/modules/properties.js"></script>
    <script src="js/modules/mortgages.js"></script>
    <script src="js/modules/utilities.js"></script>
    <script src="js/modules/contacts.js"></script>
    <script src="js/modules/tenants.js"></script>
    <script src="js/modules/rent_payments.js"></script>
    <script src="js/modules/insurance.js"></script>
    <script src="js/modules/tasks.js"></script>
    <script src="js/modules/analytics.js"></script>
    <script src="js/modules/refinance.js"></script>
    <script src="js/modules/financial_decisions.js"></script>
    <script src="js/modules/predictive_analytics.js"></script>
    <script src="js/modules/tax_optimization.js"></script>
    <script src="js/modules/automation_engine.js"></script>
    <script src="js/modules/financial_analytics.js"></script>
    <script src="js/modules/debt_paydown.js"></script>
    <script src="js/modules/kpi_monitoring.js"></script>
    <script src="js/modules/scenario_analysis.js"></script>
    <script src="js/modules/benchmarking.js"></script>
    <script src="js/modules/investment_analysis.js"></script>
    <script src="js/modules/financial_reports.js"></script>
    <script src="js/modules/ml_analytics.js"></script>
    <script src="js/modules/permissions.js"></script>
    <script src="js/modules/users.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
